<!DOCTYPE html>
<html>

<head>
<title>time to code</title>

<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<link rel="stylesheet" type="text/css" href="public/css/hostAndClient.css" />
<!-- The navigation menu -->

<link rel="stylesheet" type="text/css" href="public/css/sitemap.css" />
<style>
</style>

<noscript>
   <br/><br/><br/><br/><br/>
   <p style="font-family:Helvetica; font-size:150%; color:brown;">
   TimeToCode.org requires JavaScript.
   <br/><br/>
   Please enable JavaScript in your browser<br/>
   and then reload this page.
   </p>
   <br/><br/><br/><br/><br/><br/><br/>
</noscript>

<script src="jquery-3.1.1.min.js"></script>
<script src="math.min.js"></script>

<script src="Box2D.js"></script>
<script src="gwModule.js"></script>

<script src="hostAndClient.js"></script>

<script src="demo6.js"></script>
<script src="demo8.js"></script>

<!--
<script src="demo2b.js"></script>
-->

<!--
<script src="https://webrtc.github.io/adapter/adapter-latest.js"></script>
-->
<script src="adapter-latest.js"></script>

<!-- The navigation menu -->
<script src="w3data.js"></script>

<script>
   // Page-level global to facilitate the dynamic loading of captures for various demos.
   var demo_capture;

   // After the page loads (and canvas element is defined)....
   $(document).ready( function() {
      gW.init();
      hC.init_chatFeatures('host');
   });

</script>

</head>

<body id="thisBody">

<!-- The navigation menu -->
<div w3-include-html="sitemap.html"></div>
<script>
   function openNav() {
       document.getElementById("myNav").style.height = "100%";
   }
   function closeNav() {
       document.getElementById("myNav").style.height = "0%";
   }
   w3IncludeHTML();
</script>

<span class="menuicon" title="TTC Site Menu" style="font-size:20px; cursor:pointer;" onclick="openNav()">&#9776;</span>

<div class="main" id="mainDiv">

   <div class="containerRow" style="">
      <div class="maintext" id="multiPlayer" style="display:none">
         <div class="scroller">
         <datalist id="nodeServerList"></datalist>
         <span id="serverTitle">Server</span><input id="nodeServer" list="nodeServerList" value='secure-retreat-15768.herokuapp.com' autocomplete="off" title='Use the default unless you have an ip address (and port) for a local node server.'>
         <span id="roomTitle">Room</span><input id="roomName" autocomplete="off" maxlength="9"/>
         <button id="ConnectButton" class="chat" onclick="hC.connect_and_listen('host', 'normal');" title='Initiate (or reset) the host connection and create the game room.'>Create</button>
         <br>
         <form id="chatForm" action="" style="display:inline;">
            <input id="inputField" autocomplete="off" title="Use the 'Enter' key to submit a message."/>
            <button id="ChatButton" class="chat">Chat</button>
         </form>
         <ul id="messages"></ul>
         </div>
      </div>
      <div class="maintext" id="ttcIntro" style="display:table-cell">
         <div class="scroller" id="helpScroller">

         <p class="title">
         time to code</p>

         <p id="browserAdvice">
         (please use Chrome)</p>

         <p>Move objects with your mouse or finger. Drag and fling them. Put on the breaks with the f key.
         Try the g key.</p>

         <p>Button #7 starts the Puck Popper game. With multiple players, use #8 for more terrain. Here's a short <a title='How to play Puck Popper' href='https://youtu.be/ZAeRF1GOurA' target="_blank">video</a>.
         Try the Jello: #6.</p>

         <p><a title='show or hide the help' onclick="gW.toggleElementDisplay('outline1','block');gW.toggleSpanValue('moreOrLess','More','Less');">
         <span id='moreOrLess'>More</span></a>: on multiplayer, capture, the editor, and the games.
         </p>

         <ul id='outline1' style='display:none'>

            <li>These Canvas animations works well in Google Chrome and Mozilla Firefox.
            <a title='show or hide the help on browsers' onclick="gW.toggleElementDisplay('msEdgeBody','block');gW.toggleSpanValue('msEdgeIntro','More','Less')"><span id='msEdgeIntro'>More</span></a> on browsers...

            <span id='msEdgeBody' style='display:none'>
            <br/>
            Overall, Chrome is the best browser to use here. (You may want to stop
            reading about browsers and simply use Chrome.) However, Firefox is a
            close second to Chrome, and, depending on the hardware, I sometimes
            prefer its rendering e.g., demo #2 when running on my laptop.
            <br/><br/>
            Firefox has a "feature" that conflicts slightly with one of the editing
            features here. Right-clicking with the shift key down will always bring
            up a context menu in Firefox when the click is released, apparently
            overriding attempts to disable it. Chrome and Edge do a better job
            listening.
            <br/><br/>
            Firefox also has distinctive alt key behaviors. The alt key is used
            here to start a box-based selection. If this is played by the book (hold
            alt key down, then click and drag the mouse) all goes well. But if you
            tap the alt key (down then release) this will trigger the menu bar to be
            displayed. Any click and drag operations that follow will appear to be
            stuck in box-select mode. To reset this do two complete cycles of the
            alt key (down-up-down-up) without any mouse clicks in the middle.
            <br/><br/>
            Microsoft Edge does not support the WebRTC datachannel yet, probably coming
            soon... In multiplayer mode Edge will always revert to using the
            socket.io connection. For low-lag multiplayer performance in
            Edge you may want to try <a href="multiplayer.html"
            target="_blank">installing</a> a local node server.
            Edge is new, and can't yet be completely recommended.
            I will be testing mainly on Chrome and Firefox.
            <br/><br/>
            MS Internet Explorer is not functional here.
            <br/><br/>
            Testing is very thin on macOS. Chrome looks good there; all the
            multiplayer functionality (including WebRTC) works. Safari also looks
            good except for some minor rendering issues relating to object borders
            and dashed lines.
            <br/><br/>
            Testing on the Raspberry Pi showed that Chromium looks good there and the
            multiplayer works fine. RPi makes an excellent non-streaming client but is
            very underpowered as a host. The right-side alt key is required for box selecting objects.
            <br/><br/>
            A Chromebook makes a good streaming and non-streaming client. As a host
            it is somewhat underpowered. The touchpad differs from Windows.
            Because of the way this site uses the alt key (for box-based object
            selection), you must use a mouse to get right-click features like the
            strongest mouse springs.
            </span>
            <br>&nbsp;</li>

            <li id="numbers">Use the <strong>numbered buttons</strong> in the right
            panel to start the interactive demos and games. To restart, click the
            button again (or use the corresponding number key on the keyboard). Each
            button auto-scrolls this left panel to show corresponding information.
            The "Plus" row, below the cluster of numbered buttons, provides links to
            variations of the base demo or game (captures of edited runs). Clicking
            one of these links populates the capture box and starts the variation.
            Clicking the corresponding number button restarts the variation.
            The "_a" link in this "Plus" row acts to clear out the capture box and
            then restart the base demo. For help on the other buttons in right panel
            refer to <a onclick="gW.scrollDemoHelp('#d1234');">these topics</a>.
            </br></br>

            <li id="multi">Use the "<strong>Multiplayer</strong>" option to enable
            controls for connecting as a host to the node server. Then type a short
            room name into the red input box (on the left). Optionally, type a
            nickname for yourself into the chat input box. For example, type
            nn:Bubba to name yourself Bubba. Then click the "create" button. Wait a
            few seconds for the server to wake up. Open one (or several) client
            windows from these links:
            <a href="#" onClick="window.open('indexClient.html', '_blank', 'width=1240,height=650')">window</a>,
            <a href="indexClient.html" target='_blank'>tab</a>.
            From those client pages, repeat the connection
            process using the same room name that you specified as the host. Once
            connected, you will see your mouse and keyboard events rendering to the
            host canvas (this page). That way multiple users can simultaneously
            interact with the animated objects in the demo.
            The question-mark key can be useful for locating your puck in the Puck Popper game (demos 7 and 8).
            There's more info on the
            specifics of multiplayer game play in the topics for <a
            onclick="gW.scrollDemoHelp('#d7');">demos #7</a> and #8 below.
            <br/><br/>

            Optionally, each connected client may initiate a live <strong>video
            stream</strong> of the host's canvas. After connecting, click the
            "Stream" checkbox on the client. This works best if the host and the
            clients are running their monitors at the same refresh rate. Overall,
            Chrome is the best browser for producing smooth rendering of the stream
            on the client. If the client has limited cpu power (like a Raspberry
            Pi), it's best not to stream. Any client without a video stream has to
            be in the same physical room to see the rendering on the host's screen.
            <br/><br/>

            The <strong>Two-Thumbs</strong> touch screen interface, a virtual
            gamepad (see image below), is useful for controlling a game puck from a
            cell phone in demos 7 and 8 (Puck Popper). From your cell phone, or
            other touch-screen device, open the client page in Chrome. Connect to
            the host as described above, then click the "Two Thumbs" button. Your
            left thumb will control the jet direction and intensity (more thrust the
            farther your touch point is out from center dot). Right thumb fires and
            aims the shooter. The center rectangle turns the shield on/off.
            <br/><br/>
            <!-- image-rendering: -webkit-optimize-contrast optimizeQuality crisp-edges -->
            <img title="screen shot of the Two-Thumbs touch-screen interface" src="images/twoThumbs.png" style="max-width:100%; max-height:100%; image-rendering: -webkit-optimize-contrast">
            <br/><br/>
            The colored rectangle, below the shield control, indicates your client color. Touch
            it, and a large circle will show around your puck (helping you to find
            it). The small rectangle controls at the bottom require the alt
            rectangle to be touched first (this prevents accidental firing
            of these controls when driving the puck). These can be used to: get out
            of the full-screen mode (esc), freeze the object motion (f), restart the
            two Puck Popper games (7 and 8).
            The scope control is located in the bottom right corner of the virtual
            gamepad. This control precisely rotates the shooter tube and shoots from
            a fixed position. Touching the center block stops the movement of your
            puck, and then shoots without recoil (and no rotation). The surrounding
            two blocks, rotate the shooter tube (ccw or cw). The rotation rate is
            reduced as the touch point approaches the center block.
            <br/><br/>

            Note that you can use the Two-Thumbs interface, even when
            there is no direct line of sight to the host's screen, by starting up a second client with a video stream.
            <br/><br/>

            Also notice the "<strong>Full Screen</strong>" button (bottom right). This puts the animation canvas into full-screen mode
            and gives a nice front-and-center presentation of the demos (my favorite way to play Puck Popper). This works best in Chrome. In full-screen mode, you can scale the canvas
            up and down with the ctrl +/- keys.
            <br/><br/>

            There is more information on the <a href="multiplayer.html" target="_blank">Node.js</a>, <a href="multiplayer.html" target="_blank">socket.io</a>, and
            <a href="peer2peer.html" target="_blank">WebRTC</a> that are used here, including <a href="multiplayer.html" target="_blank">instructions</a> on
            how to install a local node server on the host computer.
            <br>&nbsp;</li>

            <li>The "<strong>Capture</strong>" button records the current state of
            a demo. The result is written to the neighboring text cell and also to
            the paste buffer. The capture can be immediately run by pressing the corresponding
            number button (this will be highlighted yellow). Restart the capture by clicking
            the button again.
            <br/><br/>
            After capturing, the results can be saved for later
            use by pasting into a text file.
            To reanimate the capture, paste the
            result back into the text cell and click the corresponding demo button.
            The capture result is in formatted JSON. Code editors work well to view
            and edit the capture with syntax highlighting (JavaScript).
            <br/><br/>
            There are links to color-highlighted examples of JSON captures in the help topic for <a onclick="gW.scrollDemoHelp('#d6');">demo #6</a>.
            These were taken following use of the editing features (see below) to
            make two circular structures from the Jello matrix.
            <br>&nbsp;</li>

            <li id="editorMark"><strong>Editing features</strong> can be used to change the characteristics of selected pucks, pins, walls, or springs.
            <br/><br/>
            Select a <strong>single</strong> object by clicking in the canvas area and then dragging the cursor over the object (or by directly clicking on the object).
            <br><br>
            Summary of the <strong>single-select</strong> commands:</li>
            <ul>
               <li>control key</li>
               <ul>
                  <li><strong>mouse drag</strong>: hold the control key down and mouse drag the object. Puck position and elasticity parameters are displayed in this mode.</li>
                  <li><strong>rotation</strong>: hold down the control and <strong>shift</strong> keys and drag the edge of the object using the mouse.</li>
               </ul>
               <li>arrow keys: <strong>resize</strong> a single object</li>
               <ul>
                  <li>up/down keys: change a rectangular object's height</li>
                  <li>left/right keys: change a rectangular object's width</li>
               </ul>
               <li>"[" and "]" keys: change the puck's <strong>restitution</strong> (bounce)</li>
               <li>"+" and "-" keys: change the <strong>surface friction</strong> (tackiness)</li>
               <li>"&lt" and "&gt" keys: change the <strong>linear damping</strong> (drag)</li>
               <li>ctrl-c: <strong>copy</strong></li>
               <li>ctrl-x: <strong>delete</strong></li>
               <br>
            </ul>
            To repeat the resizing operations keep holding the corresponding key down.
            <br/><br/>
            By default, walls and
            pins (stationary spring anchors), are not selectable unless you check the "Edit walls & pins" box. This default protects them from
            moving around under normal mouse-drag situations.
            <br/><br/>
            Check the "Edit walls & pins" box to change the characteristics of the
            static terrain for any of the demos. This includes perimeter and
            interior walls (even rotating ones). Just click and drag to move walls
            and pins. Refer to the next section, on Multi-select, for commands to rotate objects.
            <br/><br/>
            Demo #8 was constructed using the editing features and
            the state-capture feature. Modify demo #8 to create your own battle
            field: edit, then capture it.
            <br/><br/>
            <strong>Multi-select</strong> allows you to select single or multiple objects. This is the only method by which springs can be selected (by selecting their connected pucks and pins).
            <br/><br/>
            Hold the shift key down to select multiple objects during mouse drag (turn off "Select COM" to select off-center points). Hold down the alt key for box-based selection.
            <br/><br/>
            Selected objects are indicated by yellow dots; springs are dashed. To
            unselect an object, RIGHT click and drag, still using the shift (or alt) key.
            Note that right clicking with shift down in
            FireFox yields a context menu when you release the click; ignore it, try using the alt key with FireFox, or use Chrome.
            <br/><br/>
            To completely reset
            the multi-selection, release the shift (or alt) key and click on any empty space
            in the canvas area.
            <br/><br/>
            Summary of the <strong>multi-select</strong> commands:
            <ul>
               <li>control key: group <strong>drag</strong></li>
               <ul>
                  <li>hold the control key down, then click and mouse drag any body in the multi-select group causing the whole group to drag</li>
               </ul>
               <li>control and shift keys (or control and alt): group <strong>rotation</strong></li>
               <ul>
                  <li>hold both the control and <strong>shift</strong> keys down, then click and mouse drag any body in the multi-select group causing the whole group to rotate <strong>about the center</strong> of the group</li>
                  <li>hold both the control and <strong>alt</strong> keys down to cause each body to rotate <strong>about itself</strong></li>
               </ul>
               <li>arrow keys: <strong>resize</strong> single or multiple objects</li>
               <ul>
                  <li>the "s" key (hold it down) directs resizing operations at selected springs. In the default mode ("s" key up), resizing is directed at selected pucks and walls.</li>
                  <li>up/down keys change the object's length</li>
                  <li>left/right keys change the objects's width (and strength if it's a spring)</li>
               </ul>
               <li>t (and shift-t): incrementally change the rotation <strong>rate</strong>.</li>
               <li>"[" and "]" keys: change <strong>elasticity</strong></li>
               <ul>
                  <li>change the <strong>restitution</strong> (bounce) of selected pucks</li>
                  <li>with the "s" key (hold it down), change the <strong>damping</strong> (shock absorbers) on selected springs</li>
               </ul>
               <li>"+" and "-" keys: change the <strong>surface friction</strong> (tackiness)</li>
               <li>"&lt" and "&gt" keys: change the <strong>linear damping</strong> (drag)</li>
               <li>ctrl-x: <strong>deletes</strong> single or multiple objects</li>
               <ul>
                  <li>the first ctrl-x operation deletes the selected springs, a second ctrl-x deletes selected pucks and pins</li>
               </ul>
               <li>ctrl-c: <strong>copy</strong> a single spring (must have ONLY the two connected pucks or pins selected)</li>
               <li>ctrl-s: <strong>paste</strong> a single spring (onto two selected pins or pucks)</li>
               <li>ctrl-v: <strong>replicate</strong> a selected group of objects to the cursor location. Note: client pucks and navigation pins are excluded.</li>
               <br>
            </ul>
            Altering the characteristics of objects in a multi-select group, such as
            resizing, affects all members of the group. If a status message is displayed,
            it indicates the changing value of the last object selected in the group. All
            member values are scaled with the same factor (increments of 5 or 10%).
            <br/><br/>
            Copy and paste can be used to place a spring onto a pair of selected pucks or pins:
            <ol>
               <li>use multi-select to select ONE spring (two pucks/pins)</li>
               <li>copy it (ctrl-c)</li>
               <li>use multi-select to select a new pair of pucks/pins (turn off "Select COM" to select off-center points)</li>
               <li>paste the spring (ctrl-s)</li>
               <br>
            </ol>
            A few things to try with multi-select:
            <ul>
               <li>Dissect (or add to) the jello matrix in demos #6 and #8.</li>
               <li>Select a compound object (like the triangle in demo #5) and change the connecting spring lengths while it's spinning.</li>
               <li>Delete some of the pucks in demo #3. Select and delete without using the freeze button. Notice how the new holes in the puck grid propagate after wall collisions.</li>
            </ul>
            <br>

            <li id="d1234">The "<strong>Freeze</strong>" button momentarily stops all puck translation while
            allowing rotation to continue. The neighboring "<strong>R</strong>" button stops all
            rotation (use t and shift-t to change the rotation rate of a selected puck).
            The "<strong>Reverse</strong>" button flips the velocity and reverses the rotation rate of each puck.
            <br>&nbsp;</li>

            <li>Each of the <strong>three mouse buttons</strong> has a different spring strength
            for dragging objects: left click for the normal spring, center
            click for the weakest spring, right click for the strongest spring and a firmer connection
            to the larger pucks. (Note that using the right mouse button on the smallest
            pucks may cause instability in the physics engine; go ahead and try it.) If you're only
            positioning a small puck (not flinging it), try doing so with the control key down; that
            will always be stable.
            <br>&nbsp;</li>

            <li>Each demo control has <strong>keyboard shortcut</strong> letter underlined in its label.
            That is a keyboard key to use as an alternative to the mouse.<br>&nbsp;</li>

            <li>The <strong>Center Of Mass</strong> (COM) toggle controls the position of
            the selection point. With this on, you will always select the
            middle of the target object. Turning this off allows you to
            spin (or stop spinning) the objects.<br>&nbsp;</li>

            <li>The "<strong>gravity</strong>" toggle also controls several associated
            parameters in the
            <a href="https://github.com/hecht-software/box2dweb" target="_blank">Box2Dweb</a>
            physics engine: restitution, friction, and
            b2_velocityThreshold. Depending on the demo, if gravity is
            turned off, these settings are used to produce more elastic
            collisions (low energy loss) so things keep moving and don't
            stick to the walls. In demo #6, the opposite is done so that
            collisions are inelastic, reducing chatter when pucks are
            held in contact with each other under the tension of springs. Note that if you use
            the editor to change the restitution of a puck, it will remain fixed at that level, independent
            of the gravity toggle, until the demo is restarted (or the puck is edited again).
            <br>&nbsp;</li>

            <li>The "<strong>pause</strong>" toggle disables all updates to the canvas. When paused,
            a stepper button is revealed in place of the fps value; click it to advance a single frame.
            If the perimeter walls are red, the animation is paused. Uncheck the "pause" control to
            resume animation. Alternatively use the "p" key to pause and resume. The neighboring "o" key
            will single step the animation. Hold the "o" key down to repeatedly step at a slow rate.
            <br>&nbsp;</li>

            <li id="d2"><strong>Demo #2</strong> is a sound-field simulation where
            two of the pucks are emitting at 60Hz (or the refresh rate of your
            computer and monitor). The wave speed here is 3.0 m/s. The width of the
            canvas represents 6 meters. Every second a single wave is colored
            white (others are gray) so you can see that waves are propagating out
            from the puck. The set of waves are stored in a 25 element FIFO buffer.
            This gives the appearance of a tail as the puck is dragged. If you fling
            the puck so it moves at the wave speed you will see a nice shock-wave
            visualization (Mach 1 give a Mach angle of 45 degrees).
            <br><br>
            When using the single-frame stepper,
            you'll see that the 'white' wave is colored red for even more visibility.
            Pause it when the white wave is visible, then click the "step" button. Notice that the center
            of the red circle never moves, even if the puck is moving.
            <br><br>
            Here is a second version of this demo (view the
            <a href="demo2b.js.html" target="_blank">capture</a>,
            <a onclick="gW.demoStart_fromCapture(2, {'fileName':'demo2b.js'})">run it</a>).
            <br>&nbsp;</li>

            <li id="d4"><strong>Demo #4</strong> shows box2d's capability for modeling the rotation and collisions of non-spherical objects.
            This is a good one to try the <a onclick="gW.scrollDemoHelp('#editorMark');">editing</a> features. Copy one of the
            rectangles and then change its width and length. Make some copies of your copy.
            <br><br>
            Here is a capture based on this demo
            (<a href="demo4b.js.html" target="_blank">view it</a>,
            <a onclick="gW.demoStart_fromCapture(4, {'fileName':'demo4b.js'})">run it</a>).
            If you run this you'll see it looks a bit like a drone. Try using
            multi-select to select the whole drone (alt-key and mouse drag), then
            use the right arrow key to change the length of the rotors. If you make
            them long enough they will collide and stop spinning. Angular momentum
            is conserved and causes the drone body to start spinning. In a similar
            way, you can cause the rotors to collide by changing the length of the
            springs (select the whole drone, hold the s key down, then up/down arrow keys).
            <br><br>
            For this next exercise, enable wall and pin edits (click the checkbox).
            On the left side of the canvas, a spring is mounted on two pins. This
            can be used to produce a copy (shift key, then carefully mouse-drag over the pins, without selecting the wall, then
            ctrl-c) and paste it onto a pair of pucks (with the shift key down, mouse-drag over two
            pucks, then ctrl-s).
            <br><br>
            The "Freeze" (stop translation) and "R" (stop rotation) buttons are especially
            useful in this demo.
            <br>&nbsp;</li>

            <li id="d5"><strong>Demo #5</strong> introduces springs and pins.
            The spring objects model both springiness and damping behaviors.
            Pins are stationary anchor points to which springs can be
            attached.
            <br><br>
            Try using the "F" key to stop the orbiting behavior. The
            pucks in the triangle group and the large tethered-to-a-pin puck are all
            characterized as inelastic so they play well together under tension. Try
            to get the large puck inside the triangle group. Notice that the
            triangle group can be flattened out if gravity is on. Turning gravity
            off will often result in the flattened triangle popping up and moving.
            Try this a few times under the dangling large puck (might have to lower
            the two pins of the large puck, get it closer).
            <br><br>
            This is another good place to try the <a
            onclick="gW.scrollDemoHelp('#editorMark');">editing</a> features. Use
            multi-select to select the three springs on the triangle (hold shift (or
            alt) key down then mouse over the three pucks), then adjust their
            length, as a group, using the "s" and the up/down arrow keys. Use the "s" key and
            the "[" and "]" keys to change their damping coefficients. Try
            copying and pasting a spring.
            <br><br>
            Here is a Rube Goldberg type variation of this:
            <a href="demo5b.js.html" target="_blank">view it</a>,
            <a onclick="gW.demoStart_fromCapture(5, {'fileName':'demo5b.js'})">run it</a>.
            <br><br>
            And here's a simple spring pendulum that is tuned to show its two natures: vertical spring bounce and pendulum swing
            (<a href="demo5c.js.html" target="_blank">view it</a>,
            <a onclick="gW.demoStart_fromCapture(5, {'fileName':'demo5c.js'})">run it</a>). Give it a little time and you'll
            see it change back and forth between the two mode.
            <br><br>
            Traditional springs models are not native to Box2D
            and are developed here as external objects that apply forces to things
            modeled in Box2D.
            Erin Catto uses a soft-constraints approach to spring modeling (distance joints) in Box2D. Here is his
            <a href="http://box2d.org/files/GDC2011/GDC2011_Catto_Erin_Soft_Constraints.pdf" target="_blank">presentation</a> on this.
            I use the equations on page 45 to translate from k and c to frequency and damping ratio.
            <br><br>
            The following capture (<a href="demo5d.js.html" target="_blank">view it</a>,
            <a onclick="gW.demoStart_fromCapture(5, {'fileName':'demo5d.js'})">run it</a>) contrasts these two spring types:
             traditional springs on the left (yellow), and distance joints (cyan) on
            the right. Use shift-s to toggle the default spring nature
            (soft-constraints or traditional). Almost all the springs at TimeToCode
            refer to this default setting as they are being instantiated. So you can
            toggle this setting and then (you must) re-run a demo to see the change in
            behavior. The capture links in this paragraph are the exception to this
            and explicitly specify the spring nature. In this one demo capture, soft
            will stay soft, traditional will stay traditional. As usual, all the
            editing features work here, and can be used to build compound
            spring-puck groups and adjust the spring characteristics (length, spring
            constant, and damping). The key advantage of the soft constraints is
            stability: strong spring (or strong damping) forces on small masses will not be unstable. But it
            always seems that the traditional springs give a better feel, especially
            in compound groups. So I continue, for now, to leave all the
            demos starting up with traditional springs.
            <br>&nbsp;</li>

            <li id="d6"><strong>Demo #6</strong> is the basis for the
            <a href="http://pet.timetocode.org/#jello" target="_blank">Jello-Madness</a>
            game from the J-term course. The demo starts with a mildly tangled block
            of jello, it's spinning, and the tangle-timer is running. Straighten out the block
            and the tangle timer stops. The idea here is to severely tangle up
            the block for a game (drag perimeter pucks into the middle using the
            right mouse button). Use the capture button to record a good tangle.
            Then pass the mouse and keyboard to your friend and see if they can
            untangle the mess; they start by clicking the #6 button (or
            6 key). The shortest untangle time wins. The right mouse button, the freeze
            control (f key), and possibly the gravity control are useful in this
            game. Hints: one of the interior pucks is colored differently and also
            note the diagonal springs are all yellow.
            <br><br>
            Here are links to JSON captures of editor-modified versions of
            this demo (b:
            <a href="demo6b.js.html" target="_blank">view it</a>,
            <a onclick="gW.demoStart_fromCapture(6, {'fileName':'demo6b.js'})">run it</a>, and c:
            <a href="demo6c.js.html" target="_blank">view it</a>,
            <a onclick="gW.demoStart_fromCapture(6, {'fileName':'demo6c.js'})">run it</a> ).
            To see the animation, use the run-it links above. Alternately, follow the
            view-it links, copy everything, then paste into the text area under the "Capture" button. Then
            click the #6 button to run the capture.
            <br>&nbsp;</li>

             <li id="d7"><strong>Demo #7</strong> is the small version of <strong>Puck
            Popper</strong>. The object of this game is to be the last
            controlled puck remaining (all other player and drone pucks have been
            popped). The center black puck is outfitted with the client controls
            needed to play the game. Multiple network clients can play (see <a
            onclick="gW.scrollDemoHelp('#multi');">multiplayer</a> topic above). All
            network clients should first connect, then the host should click the #7
            button. <br><br>

            The w-a-s-d group of keys controls the jet that is used to move your puck.
            The "w" key fires the jet.
            The "a" and "d" keys rotate the jet clockwise and counterclockwise.
            The "s" key is used to turn the jet to a direction opposing the current motion of the puck.
            This can be useful in breaking (stopping). Subsequent "s" presses rotate
            the jet in 90-degree clockwise steps. Firing the jet, "w", resets this pattern so the flip
            operation results with the next "s" press.
            <br><br>
            The i-j-k-l group of keys controls your gun.
            The "i" key shoots bullets.
            The "j" and "l" keys rotate the gun clockwise and counterclockwise.
            The "k" key rotates the gun in 90-degree clockwise steps
            (shift-k steps counterclockwise).
            <br><br>
            Holding down the spacebar turns on a
            shield that protects you from the bullets of an opponent (you can't
            shoot when your shield is up). Target pucks will pop after 10 hits,
            client-controlled pucks pop after 20 hits.
            <br><br>
            The "friendly fire" checkbox (visible when the "Multiplayer" control is
            checked) controls whether bullets from real Puck Popper players can
            affect the health of other real players. If unchecked, human bullets can
            only impact the drones. In this mode multiple players act as a team to
            scrub out those nasty drones. Nice.
            <br><br>
            The blue pucks are drones. They try to get you (it's time to start
            using the spacebar to turn your puck shields on). The drones follow a
            path established by the blue pins. Turn on the editor to see the
            navigation path. When the editor is on, you can drag these navigation
            pins to change the drone path. These pins can also be copied and deleted
            using the features of the editor.
            <br><br>
            The multi-select features of the editor can be used to detach the drone
            from the navigation path (delete its spring). First, check that
            wall and pin edits are enabled. Box selection (click and drag with the alt key down) is useful for selecting the spring
            between the drone and the navigation pin. If you've used the ctrl-q
            feature to disable (sleep) the drone's movement and shooting, it will come
            to rest over its current pin, making it hard to select both pin and
            drone using the shift-key approach. The box selection method allows pin,
            drone, and spring to be selected in one action, the box drag. Then
            ctrl-x deletes the navigation spring.
            <br><br>
            In a similar way, you can reattach a drone by copying (ctrl-c) the
            spring from another drone and pasting (ctrl-s) it onto the free drone and a
            blue navigation pin. Remember, ctrl-q toggles drone shooting and navigation on/off, useful
            when detaching and reattaching them.
            <br><br>
            Drones can be copied, to produce a free floating drone: mouse-drag over a drone, then ctrl-c. Attach it
            to the navigation path using the methods above.
            <br><br>
            A single drone, attached to a navigation pin, can be generated by
            depressing the shift, d, and p keys together (shift-d-p). The drone and
            pin will appear at the current location of the local host's cursor. If
            wall/pin edits are enabled, you can then extend this drone's navigation
            course by copying and dragging the pin (single-select operation, ctrl-c).
            <br><br>
            Navigation forces are rendered as jets when
            the editor is off (rendered as springs when the editor is on).
            <br><br>
            The drones use raycasting to find puck targets. To hide from the ray, move behind a
            wall, behind another puck, or beyond the length of the ray.
            <br><br>
            After finding a puck, they point their
            gun to "lead" the target. This anticipates where the moving-target
            puck will be when the bullets arrive. You'll see the gun is angled slightly ahead
            of the raycast line when the target is moving. The algorithm also accounts for the motion
            of the drone.
            <br><br>
            The controlled pucks are
            inelastic and with some drag to make them a bit easier to drive (bullets and regular pucks are elastic and with no drag).
            <br><br>
            Scoring in Puck Popper (demos 7 and 8):
            <ul>
				<li>+200 for last puck-player standing
            <li>+100 for popping client and drone pucks
            <li>+50 for popping a regular puck
            <li>+10 for hitting a puck with one of your bullets
            <li>-10 for getting hit by a bullet
            <li>-1 for shooting a bullet that expires before it hits another puck
            </ul><br>
            A score summary for each player is reported in the chat panel at the end of the game (one puck left).
            <br><br>
            A leaderboard report, the top 15 scores, is displayed below the game-score summary
            table. The report consists of two query results, one table sorted by
            time, the other by score (click the link to toggle between the two tables).
            The backend of the leaderboard, a Google
            sheet, is queried depending on the version of the Puck Popper game (e.g.
            demo #7 results are reported separate from #8). Custom versions of Puck
            Popper, made using the capture feature, are reported separately as
            distinguished by a unique identifier in the capture. Game results where
            the mouse was used (in the Canvas area) or the drones are "sleeping",
            are filtered out of the reports.
            <br><br>
            From the host page, you can establish a nickname (without connecting to the multiplayer server) by typing
            the nickname phrase, e.g. nn:Jimbo, into the chat field before starting demos #7 or #8. That nickname will be used
            when reporting to the leaderboard. To go back to being anonymous, use a nickname phrase of nn: (i.e., no name).
            <br><br>
            Here are links to a JSON capture of an editor-modified version of
            this demo (4 drones in a small space; difficult to shoot your way out of this one):
            <a href="demo7c.js.html" target="_blank">view it</a>,
            <a onclick="gW.demoStart_fromCapture(7, {'fileName':'demo7c.js'})">run it</a>.
            <br>&nbsp;</li>

            <li id="d8"><strong>Demo #8</strong> is the larger version of the Puck Popper game. This is similar to #7 in that a controlled puck is created for
            the local client, each network client, and for each of the four drones (they will try to find you). For more on
            the drones refer to <a onclick="gW.scrollDemoHelp('#d7');">demo #7</a>.
            In multi-player mode all network clients should first connect, then the
            host should click the #8 button.
            <br><br>
            To play without drones, use ctrl-q to stop the drone navigation. Use the editor features to select and delete them. Then capture
            the drone-free course for repeated play.
            <br><br>
            The starting position and
            velocity for each controlled puck is randomized. #8 is intended to be a
            template that can be <a onclick="gW.scrollDemoHelp('#editorMark');">edited</a> and captured for later use. Try shooting at the
            pucks in the spring matrix.
            <br><br>
            The editor's multi-select feature is useful for carving/slicing up the jello. Hold the shift key down, then mouse over pucks in the jello grid.
            A first ctrl-x will delete selected springs, a second ctrl-x will delete the selected pucks.
            <br><br>
            The controlled pucks are
            inelastic and with some drag to make them a bit easier to drive (bullets are elastic and with no drag; regular pucks are inelastic and with no drag).
            <br>&nbsp;</li>

            <li id="d9"><strong>Demo #9</strong> animates the additive mixing of three colors: red, green, and blue.
            The blending features of the HTML5 canvas facilitate the color mixing. The globalCompositeOperation attribute is set to a value of 'screen'.
            <br><br>
            The three balls are coupled together with three distance
            joints (aka springs, with damping). Each ball is also lightly coupled
            to a corresponding stationary pin and has some linear damping (fluid drag).
            When "Edit walls & pins" feature is enabled (checked), the pins and
            springs are visible.
            <br><br>
            Puck-puck collisions are
            inhibited by using the collideConnected attribute of the distance joint.
            If pucks are copied, they will collide with any pucks not coupled to
            them with a distance joint.
            <br><br>
            Normal editing and capture features apply here. Use the box-selection
            feature (alt key) for an easy way to copy or modify the three-puck
            group. To include the pins in copy operations, the "Edit walls & pins"
            feature must be enabled.
            <br><br>
            This demo runs most efficiently in Google Chrome. Frame rates will dip below
            target for other browsers, especially if the "Edit walls & pins"
            feature is enabled.
            <br>&nbsp;</li>

            <li>These demos try to run at a <strong>frame rate</strong> that is equal to the refresh rate of your display.
            This frame rate is reported to the right of the "pause" control. The
            value should be about 60fps if your display's refresh rate is set to 60
            Hertz. Cell phones will generally not be able to reach 60fps for most of
            the demos.<br><br>

            Below the "pause" control is a selection control used in establishing a
            fixed timestep for the physics-engine (inversely related to framerate).
            This is automatically set (based on an observation of your framerate) whenever
            the page is refreshed.
            <br><br>

            Generally this will get set
            to 60 Hertz unless you have a DVI or Display Port connection to a
            monitor that can render at higher rates. Note that the longer timestep of the 30
            Hertz setting will be unstable in demos that
            incorporate springs.<br><br>

            Direct mouse drag (and rotation) of single or multiple objects will produce instability when
            editing spring systems at rates of 60 Hz or less. At 100 Hz or higher these operations work
            the best.
            <br><br>

            If you do have high-refresh-rate gear,
            try setting your monitor to a refresh rate that the demos can easily
            match. If a demo is running slower (fps) than your monitor's refresh
            rate, try reducing your monitor's rate (in Windows 10, right click on
            the desktop, then "display setting", then "advanced display setting",
            then "display adapter properties", then "monitor" tab, then change the
            "screen refresh rate"). Then, after you have dialed back your monitor to the point that
            the demos can match it, set the timestep control to agree with that value (or refresh the
            page to set it automatically).<br><br>

            At the beginning of the timestep select list, you'll
            see the option "variable". This lets the physics timestep (framerate)
            float along with the refresh rate of your monitor. This can be handy for
            observing the fps performance of your system.
            Generally it's best to only use this to test. Then set a similar fixed-timestep value.
            <br>&nbsp;</li>
         </ul>

         <p>The <a href="#" onClick="window.open('indexClient.html', '_blank', 'width=1320, height=650')" title="Open a client page in a new window.">client</a>
         interface for multiplayer includes a virtual gamepad for cell phones.
         Try it. Click the multiplayer option here to start hosting a game.
         Type in a room name, and then click the "Create" button. On your cell phone, from the client page, enter the room name and then touch the "Connect" button.
         After connecting your cell-phone client to the host, touch the "Two-Thumbs" button.</p>

         <p>This site hosts a collection of code scripts: Python (see
         <a href="http://pet.timetocode.org/index.html">game</a> physics),
         JavaScript (see what's animating this page:
         <a href="gwModule.js.html" target="_blank">a</a>,
         <a href="hostAndClient.js.html" target="_blank">b</a>,
         <a href="server.js.html" target="_blank">c</a>,
         <a href="package.json.html" target="_blank">d</a>),
         and VBScript and Perl (see <a href="http://waconia.timetocode.org/index.html">Waconia</a>).
         There may be a few R scripts coming...</p>

         <p>The functionality of the Python game-physics page is
         reproduced here with JavaScript, <a href="https://github.com/hecht-software/box2dweb"
         target="_blank">Box2dWeb</a>, and a live HTML5 Canvas. This includes the
         use of Node.js, socket.io, and WebRTC for <a href="multiplayer.html" target="_blank">multiplayer</a>.</p>

         <p>There's a back-burner plan for a new Waconia page
         based on Google Charts, client sided this time.</p>

         <p>Here's the team at the <a href="https://www.youtube.com/watch?v=-LQtBxP9SDs" target="_blank">
         rec-center</a> and a note on what's coming <a href="rev-history.html" target="_blank">next</a>...</p>

         </div>
      </div>
      <div class="canvas" id="hostCanvasDiv"
    style="width:600px; height:600px; position:relative; top: 0px; left: 0px; z-index:2;">
    <canvas id="hostCanvas" width="600" height="600" onclick="document.activeElement.blur();">
    </canvas>
    <div style="width:600px; height:600px; margin-top : -600px ; z-index:1;">
        <video autoplay id="hostvideo" width="600" height="600" onclick="document.activeElement.blur();"></video>
    </div>
</div>



      <div class="controls" id="controlsDiv">
         <button class="main" title='stop translation' onclick="gW.freeze();"><u>F</u>reeze</button>
         <button class="main" title="stop rotation" onclick="gW.stopRotation();"><u>R</u></button>
         <button class="main" title="reverse the velocity and rotation rate" onclick="gW.reverseDirection();">Reverse</button><br>
         <p>
            <input type="checkbox" id="chkGravity" autocomplete="off" title="add some gravity to the situation"><u>G</u>ravity <br>
            <input type="checkbox" id="chkCOM_Selection" title='change how objects are selected (use Center Of Mass or not)' autocomplete="off" checked>Select <u>C</u>OM<br><br>
            <input type="checkbox" id="chkPause" autocomplete="off" title="stop/start the animation"><u>P</u>ause

            <span id='fps_wrapper' style='display:inline'>
            (<span id="fps" title="animation rate in frames per second">0</span>fps)
            </span>

            <span id='stepper_wrapper' style='display:none'>
            <button class="main" id="stepper" title="step the animation by one frame" onclick="gW.stepAnimation();">Step</button><br>
            </span>

            <select id="FrameRate" onChange="gW.setFrameRate();" autocomplete="off" title="physics-engine timestep in milliseconds">
               <option value="float"       >variable</option>
               <option value="30"          >33ms (30Hz)</option>
               <option value="60"  selected>17ms (60Hz)</option>
               <option value="85"          >12ms (85Hz)</option>
               <option value="100"         >10ms (100Hz)</option>
               <option value="120"         >&nbsp;&nbsp;8ms (120Hz)</option>
               <option value="144"         >&nbsp;&nbsp;7ms (144Hz)</option>
               <option value="240"         >&nbsp;&nbsp;4ms (240Hz)</option>
            </select>


         </p>
         <input type="checkbox" id="chkMultiplayer" autocomplete="off" title="Toggle the left panel between multiplayer features and the demo help."><u>M</u>ultiplayer<br>
         <span id='clientLinks' style='display:none'>
            <input type="checkbox" checked id="chkStream" autocomplete="off" title="Uncheck to pause all video streams to the clients.">Streams<br>
            <input type="checkbox"         id="chkLocalCursor" autocomplete="off" title="Render the local cursor when over the canvas element">Local cursor<br>
            <input type='checkbox' checked id='chkPlayer' autocomplete='off' title=
'Request a puck player for the local host
when starting demos 7 and 8.'>Host player<br>
            <input type='checkbox' checked id='chkFriendlyFire' autocomplete='off' title=
'Allow bullets from humans to hit humans.
Uncheck this for team play where multiple
players work together to scrub out the
drones.'>Friendly fire<br>
            &nbsp;Client:
            <a href="#" onClick="window.open('indexClient.html', '_blank', 'width=1320, height=650')" title="Open a client page in a new window.">window</a>,
            <a href="indexClient.html" target='_blank' title="Open a client page in a new tab.">tab</a>
            <br>
         </span><br>
         &nbsp;Demos and Games:
         <div id="buttonGroup">
         <button class="demos" onclick="gW.demoStart(1);" id="b1" title="big and little"><u>1</u></button>
         <button class="demos" onclick="gW.demoStart(2);" id="b2" title="sound field"><u>2</u></button>
         <button class="demos" onclick="gW.demoStart(3);" id="b3" title="order and disorder"><u>3</u></button><br>

         <button class="demos" onclick="gW.demoStart(4);" id="b4" title="rectangular symmetry"><u>4</u></button>
         <button class="demos" onclick="gW.demoStart(5);" id="b5" title="stretchy things"><u>5</u></button>
         <button class="demos" onclick="gW.demoStart(6);" id="b6" title="Jello Madness"><u>6</u></button><br>

         <button class="demos" onclick="gW.demoStart(7);" id="b7" title="Puck Popper"><u>7</u></button>
         <button class="demos" onclick="gW.demoStart(8);" id="b8" title="Puck Popper (with jello)"><u>8</u></button><br>
         <button class="demos" onclick="gW.demoStart(9);" id="b9" title="color mixer"><u>9</u></button>
         </div>

         <div id="variationLine">&nbsp;<span title='variations on the demos'>Plus:</span> <span id='extraDemos'></span></div>

         <div id="divFullScreen"><button class="main" id="btnFullScreen" title="Full screen view of the Canvas element (esc to return to normal view)">Full Scree<u>n</u></button></div>

         <div id="divEditorChk"><input type="checkbox" id="chkEditor" autocomplete="off" title="change the unchangeable"><u>E</u>dit walls & pins</div>

         <button class="main" onclick="gW.saveState();"
                 title="capture object state and store in text area and paste buffer">Capture</button>
         <button class="main" onclick="gW.clearState();" title="clear out the capture text area">Clear</button>
         <button hidden class="main" onclick="gW.cleanCapture();" title="clean up a little">CC</button><br>
         <textarea id="jsonCapture" autocomplete="off" title="text area for storing the capture"></textarea><br>
      </div>

   </div>
</div>

</body>
</html>
